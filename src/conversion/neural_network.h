#include <stdint.h>
#include "math/matrix.h"
#include "layers/cells.h"
#include "layers/layers.h"
#include "math/matrix_ops.h"
#include "math/fixed_point_ops.h"

#ifndef NEURAL_NETWORK_GUARD
#define NEURAL_NETWORK_GUARD

#define FIXED_POINT_PRECISION 10

#define IS_COMPRESSED 1

enum ModelClass { STANDARD = 0, ADAPTIVE = 1 };
enum ModelType { VANILLA = 0, SAMPLE = 1, BOW = 2, RNN = 3, BIRNN = 4 };
enum OutputType { REGRESSION = 0, BINARY_CLASSIFICATION = 1, MULTI_CLASSIFICATION = 2 };
static enum ModelClass MODEL_CLASS = ADAPTIVE;
static enum ModelType MODEL_TYPE = SAMPLE;
static enum OutputType OUTPUT_TYPE = MULTI_CLASSIFICATION;
#define STATE_SIZE 20
#define SEQ_LENGTH 20
#define SAMPLES_PER_SEQ 2
#define NUM_SEQUENCES 10
#define NUM_INPUT_FEATURES 3
#define NUM_OUTPUT_FEATURES 6
static int16_t INPUT_MEAN[3] = { 851,7572,271 };
static int16_t INPUT_STD[3] = { 7045,7091,4891 };
static int16_t OUTPUT_MEAN[6] = { 0,0,0,0,0,0 };
static int16_t OUTPUT_STD[6] = { 1024,1024,1024,1024,1024,1024 };

static int16_t THRESHOLDS[10] = { 338,527,437,427,309,457,345,568,550,671 };

static dtype FUSION_BIAS_0[20] = { -218,-430,-752,105,-308,-211,54,-132,-207,-369,-559,-167,-427,-63,-242,-162,-117,-194,-314,-944 };
static matrix FUSION_BIAS_0_MAT_VAR = { FUSION_BIAS_0, 20, 1 };
static matrix * FUSION_BIAS_0_MAT = &FUSION_BIAS_0_MAT_VAR;

static dtype FUSION_KERNEL_0[200] = { -113,309,-118,-348,335,-64,178,-349,-215,171,-312,-80,84,-194,126,-15,20,-300,-157,289,210,-261,-67,-30,305,179,213,-553,-32,137,-273,233,147,24,-236,-135,-413,328,-138,-15,-55,57,394,173,-182,-459,17,-588,22,-373,251,328,203,-27,97,-3,-792,110,291,77,-140,397,45,-127,454,585,-89,-439,-215,86,128,51,-626,-302,-157,-49,-668,-124,215,-324,411,443,98,505,607,-208,-167,-161,-206,-86,-724,-46,84,-203,52,-153,-517,-308,179,87,-482,-127,145,-16,-288,-322,191,-233,-379,59,-28,-202,59,235,-37,-6,377,350,-172,-322,71,232,218,-565,-425,388,-608,-326,-701,-650,212,61,-660,342,-297,-393,309,347,168,529,3,-995,-109,81,-533,-239,-59,662,262,-204,188,-13,-433,101,-148,-179,345,-551,439,385,278,366,-42,-106,-852,-879,-340,-176,-65,217,-662,-109,368,496,302,99,-257,231,-253,55,-192,75,403,200,35,-218,203,140,-271,-152,-42,279,-163,-10,-10,-49,-660,-284,-81,-222 };
static matrix FUSION_KERNEL_0_MAT_VAR = { FUSION_KERNEL_0, 200, 1 };
static matrix * FUSION_KERNEL_0_MAT = &FUSION_KERNEL_0_MAT_VAR;

static dtype EMBEDDING_BIAS_0[20] = { -48,646,-390,-543,248,294,148,499,-179,267,246,-239,-247,-226,146,766,893,-311,-275,166 };
static matrix EMBEDDING_BIAS_0_MAT_VAR = { EMBEDDING_BIAS_0, 20, 1 };
static matrix * EMBEDDING_BIAS_0_MAT = &EMBEDDING_BIAS_0_MAT_VAR;

static dtype EMBEDDING_KERNEL_0[15] = { -57,-220,802,769,557,-107,849,396,-564,955,-356,-410,347,289,708 };
static matrix EMBEDDING_KERNEL_0_MAT_VAR = { EMBEDDING_KERNEL_0, 15, 1 };
static matrix * EMBEDDING_KERNEL_0_MAT = &EMBEDDING_KERNEL_0_MAT_VAR;

static dtype OUTPUT_HIDDEN_BIAS_0[32] = { -517,219,-119,-596,-177,0,-78,-497,-77,-247,-435,24,-1241,421,-605,-80,192,31,-191,-62,-52,-541,161,-153,54,-187,-93,16,-815,-81,-493,-131 };
static matrix OUTPUT_HIDDEN_BIAS_0_MAT_VAR = { OUTPUT_HIDDEN_BIAS_0, 32, 1 };
static matrix * OUTPUT_HIDDEN_BIAS_0_MAT = &OUTPUT_HIDDEN_BIAS_0_MAT_VAR;

static dtype OUTPUT_HIDDEN_KERNEL_0[160] = { 83,-87,279,31,-14,-287,-275,425,27,320,-27,319,-39,217,-292,166,110,125,256,59,58,134,402,423,-318,110,195,-113,283,267,-368,-214,-177,74,-474,-399,101,271,-201,-450,-331,310,-132,-846,-89,-228,550,-879,-166,63,688,239,-651,-445,-166,-145,-184,-689,272,-129,302,-284,-224,1,177,-199,10,60,-25,60,206,-36,-162,355,-285,33,63,-92,343,-146,185,6,-20,631,-402,-18,-28,271,-394,257,-260,-75,165,-23,91,-297,-11,8,-188,125,211,94,140,143,128,428,-415,5,-638,-53,163,258,207,113,115,160,38,-300,-126,69,178,-124,-38,-137,-55,137,-265,114,401,-246,-402,-20,-466,-562,383,30,300,319,-148,261,180,-184,30,-156,-397,-616,33,-267,-56,-53,-45,-25,-258,-378,25,262,362,-181,390,-495 };
static matrix OUTPUT_HIDDEN_KERNEL_0_MAT_VAR = { OUTPUT_HIDDEN_KERNEL_0, 160, 1 };
static matrix * OUTPUT_HIDDEN_KERNEL_0_MAT = &OUTPUT_HIDDEN_KERNEL_0_MAT_VAR;

static dtype OUTPUT_HIDDEN_BIAS_1[32] = { -1180,295,310,365,477,-57,111,233,-459,-733,670,44,-280,94,44,-110,-536,70,-754,252,63,0,54,132,85,-558,226,-543,30,386,12,17 };
static matrix OUTPUT_HIDDEN_BIAS_1_MAT_VAR = { OUTPUT_HIDDEN_BIAS_1, 32, 1 };
static matrix * OUTPUT_HIDDEN_BIAS_1_MAT = &OUTPUT_HIDDEN_BIAS_1_MAT_VAR;

static dtype OUTPUT_HIDDEN_KERNEL_1[256] = { 24,-311,-79,-127,564,-16,-229,-50,-206,-151,-58,56,-50,-599,-246,-11,-35,73,259,188,-194,-279,69,-5,-32,82,129,-413,190,-529,41,-128,-77,-1,-189,17,-141,23,-303,120,-651,-67,-148,426,233,-140,-73,-217,30,64,-229,-114,178,-5,-498,275,-5,-13,-7,-167,22,1,-1282,-266,-636,135,-98,-140,722,344,-98,161,16,-82,46,223,84,-26,33,174,457,-137,-417,149,133,-15,270,164,-459,-68,-210,-335,187,208,26,-19,-774,120,144,-226,-18,-23,-126,-69,-256,249,-135,198,-139,-296,-23,-120,-101,-2,114,12,766,57,-102,14,-290,-56,-476,-83,-17,694,-682,-117,5,-15,31,36,-88,72,-370,87,-103,14,50,-35,-20,-41,-6,223,153,-507,230,-392,-788,-32,114,65,-87,-203,100,-5,-255,116,569,-139,485,230,292,32,-260,111,155,-99,-483,264,833,499,-373,-120,-56,68,83,134,-1018,-103,92,-1324,872,97,-67,734,55,128,-443,23,-24,240,108,3,-35,321,-36,889,-472,-148,370,-30,8,-217,67,567,14,-14,87,136,30,-292,-65,-1320,568,6,-73,105,-380,-86,58,33,17,-44,337,359,82,215,0,4,-103,174,-273,7,956,158,-3,1141,-581,-304,597,15,-10,-178,77,29,-342,-596,9,-92,-75,36,72,258,-368,215 };
static matrix OUTPUT_HIDDEN_KERNEL_1_MAT_VAR = { OUTPUT_HIDDEN_KERNEL_1, 256, 1 };
static matrix * OUTPUT_HIDDEN_KERNEL_1_MAT = &OUTPUT_HIDDEN_KERNEL_1_MAT_VAR;

static dtype OUTPUT_BIAS_0[6] = { 294,-494,223,30,-585,-972 };
static matrix OUTPUT_BIAS_0_MAT_VAR = { OUTPUT_BIAS_0, 6, 1 };
static matrix * OUTPUT_BIAS_0_MAT = &OUTPUT_BIAS_0_MAT_VAR;

static dtype OUTPUT_KERNEL_0[48] = { 25,110,292,-51,311,167,0,69,49,-77,1801,-340,223,-73,-1336,-58,-55,-848,255,-179,248,1326,73,-74,125,489,155,-1401,-110,348,-233,190,-158,-57,433,-1577,134,-374,328,-794,336,-92,-196,-158,25,144,-365,-323 };
static matrix OUTPUT_KERNEL_0_MAT_VAR = { OUTPUT_KERNEL_0, 48, 1 };
static matrix * OUTPUT_KERNEL_0_MAT = &OUTPUT_KERNEL_0_MAT_VAR;

static dtype TRANSFORM_RNN_CELL_U_KERNEL_0[100] = { -82,62,36,-92,-286,-6,238,-269,154,165,519,225,23,170,305,-4,-107,141,-126,82,144,-90,26,10,40,364,185,-91,292,114,49,83,292,22,-37,93,-45,-20,148,-86,35,-203,488,1,18,21,-142,33,-375,-531,-5,-260,30,-112,-172,102,151,-172,-262,204,97,-101,-246,-334,317,54,106,376,114,247,-149,20,-38,149,-160,-58,83,-241,-171,140,-1072,-205,75,28,-105,-105,198,-297,208,-19,-199,-113,-4,-213,-242,-83,190,134,-113,-137 };
static matrix TRANSFORM_RNN_CELL_U_KERNEL_0_MAT_VAR = { TRANSFORM_RNN_CELL_U_KERNEL_0, 100, 1 };
static matrix * TRANSFORM_RNN_CELL_U_KERNEL_0_MAT = &TRANSFORM_RNN_CELL_U_KERNEL_0_MAT_VAR;

static dtype TRANSFORM_RNN_CELL_U_RESET_KERNEL_0[100] = { 29,-581,-265,-319,-839,-89,158,-150,320,33,-246,-1043,91,-408,-540,-360,442,232,-91,146,-28,704,422,-309,158,77,273,-210,112,0,176,-85,149,535,-360,-132,152,-267,-746,822,-38,-175,834,344,298,109,-198,-4,272,-265,-64,948,-619,-61,-298,570,711,24,404,-324,-111,-191,-89,38,-470,-138,-73,-183,-100,241,-123,-90,-346,-154,1081,1073,-134,-97,178,324,214,75,172,214,-294,990,-689,32,682,-104,158,210,-450,-55,78,-46,360,-478,68,-364 };
static matrix TRANSFORM_RNN_CELL_U_RESET_KERNEL_0_MAT_VAR = { TRANSFORM_RNN_CELL_U_RESET_KERNEL_0, 100, 1 };
static matrix * TRANSFORM_RNN_CELL_U_RESET_KERNEL_0_MAT = &TRANSFORM_RNN_CELL_U_RESET_KERNEL_0_MAT_VAR;

static dtype TRANSFORM_RNN_CELL_U_UPDATE_KERNEL_0[100] = { 583,-680,158,-179,100,58,308,-258,267,56,90,-179,92,473,-133,-106,-157,-260,-25,91,631,347,54,41,-114,-545,-337,554,35,362,-587,-224,-466,-614,125,-456,284,-461,130,54,-341,477,-45,-250,67,9,106,-139,229,385,-585,153,697,-374,-19,87,-13,-5,-302,-524,-86,-838,240,461,211,-162,211,-44,173,-191,103,145,-12,402,-221,-28,-224,-111,257,146,242,-377,-200,58,322,-284,-144,235,67,-253,-50,-269,33,-173,-49,-132,653,177,-83,-585 };
static matrix TRANSFORM_RNN_CELL_U_UPDATE_KERNEL_0_MAT_VAR = { TRANSFORM_RNN_CELL_U_UPDATE_KERNEL_0, 100, 1 };
static matrix * TRANSFORM_RNN_CELL_U_UPDATE_KERNEL_0_MAT = &TRANSFORM_RNN_CELL_U_UPDATE_KERNEL_0_MAT_VAR;

static dtype TRANSFORM_RNN_CELL_W_KERNEL_0[100] = { 398,458,126,136,-445,124,-516,-256,-277,-212,-93,-505,-340,-51,110,109,-268,21,-48,-330,279,-378,-118,22,-354,9,99,144,-307,-162,-304,-129,99,-551,-135,-64,-295,-80,308,-598,337,340,111,395,-245,68,-203,165,470,-120,425,-18,-55,-26,-8,-349,-208,33,-373,-5,-235,-45,-119,-104,-324,-37,194,478,-37,-136,-535,-695,159,-151,116,-567,-308,26,-126,120,-218,279,992,-50,614,-884,-371,-934,17,193,108,22,7,-111,478,-304,321,253,544,-114 };
static matrix TRANSFORM_RNN_CELL_W_KERNEL_0_MAT_VAR = { TRANSFORM_RNN_CELL_W_KERNEL_0, 100, 1 };
static matrix * TRANSFORM_RNN_CELL_W_KERNEL_0_MAT = &TRANSFORM_RNN_CELL_W_KERNEL_0_MAT_VAR;

static dtype TRANSFORM_RNN_CELL_W_RESET_KERNEL_0[100] = { 93,204,-116,163,-34,306,635,-134,-36,382,-706,46,120,818,163,-901,-47,495,-809,312,182,268,236,-403,684,-254,525,47,-59,73,200,486,-297,123,615,91,-10,958,-552,73,-193,-229,910,602,-392,308,66,138,209,-138,669,299,-161,670,202,-71,376,494,699,463,436,556,-50,-210,-396,243,-376,-98,311,-296,-368,-165,-252,342,-564,381,129,-239,268,-990,862,-401,236,-584,297,321,-622,261,-121,127,-763,187,-114,-414,-892,506,-64,-45,42,-609 };
static matrix TRANSFORM_RNN_CELL_W_RESET_KERNEL_0_MAT_VAR = { TRANSFORM_RNN_CELL_W_RESET_KERNEL_0, 100, 1 };
static matrix * TRANSFORM_RNN_CELL_W_RESET_KERNEL_0_MAT = &TRANSFORM_RNN_CELL_W_RESET_KERNEL_0_MAT_VAR;

static dtype TRANSFORM_RNN_CELL_W_UPDATE_KERNEL_0[100] = { -101,-255,474,172,150,374,262,1,-169,-216,163,-583,327,-102,-34,-1013,351,585,22,201,-21,-378,436,-330,102,89,625,270,-472,16,12,-299,640,-239,-436,-528,-225,73,-32,64,0,-64,-276,218,804,-166,64,115,-435,-70,-122,-738,81,57,177,-28,33,-457,112,159,222,-7,338,-62,416,-222,-393,774,292,-290,14,-118,-49,174,-165,134,-55,-102,323,-363,297,-304,338,53,314,-54,6,-27,-553,-199,413,-409,25,605,-25,7,-339,23,0,-95 };
static matrix TRANSFORM_RNN_CELL_W_UPDATE_KERNEL_0_MAT_VAR = { TRANSFORM_RNN_CELL_W_UPDATE_KERNEL_0, 100, 1 };
static matrix * TRANSFORM_RNN_CELL_W_UPDATE_KERNEL_0_MAT = &TRANSFORM_RNN_CELL_W_UPDATE_KERNEL_0_MAT_VAR;

static dtype TRANSFORM_RNN_CELL_B_BIAS_0[20] = { -94,316,-122,77,-6,34,729,339,57,133,43,-25,-230,-291,168,7,345,-375,-262,619 };
static matrix TRANSFORM_RNN_CELL_B_BIAS_0_MAT_VAR = { TRANSFORM_RNN_CELL_B_BIAS_0, 20, 1 };
static matrix * TRANSFORM_RNN_CELL_B_BIAS_0_MAT = &TRANSFORM_RNN_CELL_B_BIAS_0_MAT_VAR;

static dtype TRANSFORM_RNN_CELL_B_RESET_BIAS_0[20] = { 139,-686,348,-179,-64,-18,62,328,-836,385,-204,-206,98,304,-250,-89,-86,-560,240,-284 };
static matrix TRANSFORM_RNN_CELL_B_RESET_BIAS_0_MAT_VAR = { TRANSFORM_RNN_CELL_B_RESET_BIAS_0, 20, 1 };
static matrix * TRANSFORM_RNN_CELL_B_RESET_BIAS_0_MAT = &TRANSFORM_RNN_CELL_B_RESET_BIAS_0_MAT_VAR;

static dtype TRANSFORM_RNN_CELL_B_UPDATE_BIAS_0[20] = { -572,-589,88,-468,-408,-23,-590,-392,3,-367,-110,-474,-417,295,190,-640,-296,-138,-863,-650 };
static matrix TRANSFORM_RNN_CELL_B_UPDATE_BIAS_0_MAT_VAR = { TRANSFORM_RNN_CELL_B_UPDATE_BIAS_0, 20, 1 };
static matrix * TRANSFORM_RNN_CELL_B_UPDATE_BIAS_0_MAT = &TRANSFORM_RNN_CELL_B_UPDATE_BIAS_0_MAT_VAR;


int8_t *execute_model(matrix *inputs[SEQ_LENGTH], int8_t *outputs);
#endif
